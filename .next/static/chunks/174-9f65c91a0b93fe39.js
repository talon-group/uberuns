(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[174],{2174:function(e,r,a){"use strict";a.d(r,{AccountFormAsPage:function(){return d},default:function(){return o}});var t=a(7437),n=a(2265),s=a(41),l=a(9233),i=a(3101);function o(e){let{user:r}=e,a=(0,s.e)(),[o,d]=(0,n.useState)(!0),[u,m]=(0,n.useState)(null),[c,f]=(0,n.useState)(""),[x,g]=(0,n.useState)(null),[h,p]=(0,n.useState)(void 0);(0,n.useEffect)(()=>{r&&p(r.email)},[r]);let b=(0,n.useCallback)(async()=>{try{if(d(!0),console.log("Fetching profile data for user ID:",null==r?void 0:r.id),console.log("Fetching profile data for user email:",h),!h){console.warn("User email is undefined, cannot fetch userdatas");return}let{data:e,error:t,status:n}=await a.from("users").select("full_name, userdatas").eq("id",null==r?void 0:r.id).single();if(t&&406!==n)throw console.error(t),t;if(e){if(m(e.full_name),e.userdatas){console.log("Userdatas ID found, fetching userdatas");let{data:t,error:n}=await a.from("userdatas").select("*").eq("id",e.userdatas).single();if(t)g(t),null!=t.memberid&&f(t.memberid.toString());else{console.warn("Userdatas ID is invalid, fetching userdatas by email:",h);let{data:e,error:t}=await a.from("userdatas").select("*").eq("e_mail",h).single();if(e){g(e);let{error:t}=await a.from("users").update({userdatas:e.id}).eq("id",null==r?void 0:r.id);if(t)throw t;null!=e.memberid&&f(e.memberid.toString())}else console.warn("No matching email found in userdatas table"),g(null)}}else{console.log("No userdatas ID, fetching userdatas by email:",h);let{data:e,error:t}=await a.from("userdatas").select("*").eq("e_mail",h).single();if(e){g(e);let{error:t}=await a.from("users").update({userdatas:e.id}).eq("id",null==r?void 0:r.id);if(t)throw t;null!=e.memberid&&f(e.memberid.toString())}else console.warn("No matching email found in userdatas table"),g(null)}}}catch(e){console.error("Error loading user data:",e.message),alert("Error loading user data!")}finally{d(!1)}},[r,h,a]);async function v(){try{if(d(!0),x){let{id:e,...r}=x,{error:t}=await a.from("userdatas").update(r).eq("id",e);if(t)throw t}else{var e;let{error:r}=await a.from("userdatas").insert({e_mail:h,memberid:c?parseInt(c):null,fanclub:"",nachname:"",vorname:"",adresse:"",plz:""}).single();if(r)throw r;let{data:t,error:n}=await a.from("userdatas").select("*").eq("e_mail",h).single();if(n)throw n;g(t||{}),f((null==t?void 0:null===(e=t.memberid)||void 0===e?void 0:e.toString())||"")}let{error:t}=await a.from("users").update({full_name:u,userdatas:(null==x?void 0:x.id)||c?parseInt(c):null}).eq("id",null==r?void 0:r.id);if(t)throw t;alert("Profile updated!")}catch(e){console.error("Error updating profile:",e.message),alert("Error updating profile!")}finally{d(!1)}}async function y(){try{d(!0);let{data:e,error:r}=await a.from("userdatas").select("memberid").order("memberid",{ascending:!1}).limit(1).single();if(r)throw r;let t=e?e.memberid+1:1,{error:n}=await a.from("userdatas").update({memberid:t}).eq("id",null==x?void 0:x.id);if(n)throw n;f(t.toString()),alert("New Member ID generated!")}catch(e){console.error("Error generating member ID:",e.message),alert("Error generating member ID!")}finally{d(!1)}}(0,n.useEffect)(()=>{h&&b()},[h,b]);let N=e=>{let{name:r,value:a}=e.target;g(e=>({...e,[r]:a}))};return(0,t.jsx)(i.Z,{title:"Your Profile",footer:(0,t.jsx)(l.Z,{variant:"slim",onClick:v,disabled:o,loading:o,children:o?"Loading ...":"Update"}),children:(0,t.jsx)("div",{className:"form-widget space-y-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email"}),(0,t.jsx)("input",{id:"email",type:"text",value:null==r?void 0:r.email,disabled:!0,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"fullname",className:"text-sm font-medium text-gray-700",children:"Full Name"}),(0,t.jsx)("input",{id:"fullname",name:"fullname",type:"text",value:u||"",onChange:e=>m(e.target.value),className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"memberid",className:"text-sm font-medium text-gray-700",children:"Member ID"}),(0,t.jsx)("input",{id:"memberid",name:"memberid",type:"text",value:c,onChange:e=>f(e.target.value),className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"}),(0,t.jsx)("button",{type:"button",onClick:y,className:"mt-2 px-4 py-2 bg-pink-600 text-white rounded-md hover:bg-pink-700",children:"Generate Member ID"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"fanclub",className:"text-sm font-medium text-gray-700",children:"Fanclub"}),(0,t.jsx)("input",{id:"fanclub",name:"fanclub",type:"text",value:(null==x?void 0:x.fanclub)||"",onChange:N,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"nachname",className:"text-sm font-medium text-gray-700",children:"Nachname"}),(0,t.jsx)("input",{id:"nachname",name:"nachname",type:"text",value:(null==x?void 0:x.nachname)||"",onChange:N,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"vorname",className:"text-sm font-medium text-gray-700",children:"Vorname"}),(0,t.jsx)("input",{id:"vorname",name:"vorname",type:"text",value:(null==x?void 0:x.vorname)||"",onChange:N,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"adresse",className:"text-sm font-medium text-gray-700",children:"Adresse"}),(0,t.jsx)("input",{id:"adresse",name:"adresse",type:"text",value:(null==x?void 0:x.adresse)||"",onChange:N,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"plz",className:"text-sm font-medium text-gray-700",children:"PLZ"}),(0,t.jsx)("input",{id:"plz",name:"plz",type:"text",value:(null==x?void 0:x.plz)||"",onChange:N,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"e_mail",className:"text-sm font-medium text-gray-700",children:"E-Mail"}),(0,t.jsx)("input",{id:"e_mail",name:"e_mail",type:"text",value:(null==x?void 0:x.e_mail)||"",onChange:N,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]})]})})})}async function d(){let e=(0,s.e)(),{data:{user:r}}=await e.auth.getUser();return(0,t.jsx)(o,{user:r})}},7568:function(e,r,a){"use strict";a.d(r,{default:function(){return f}});var t=a(7437),n=a(6800),s=a.n(n),l=a(2265),i=a(1085),o=a.n(i),d=()=>(0,t.jsxs)("span",{className:o().root,children:[(0,t.jsx)("span",{}),(0,t.jsx)("span",{}),(0,t.jsx)("span",{})]}),u=a(7335),m=a.n(u);let c=(0,l.forwardRef)((e,r)=>{var a;let{className:n,variant:i="flat",children:o,active:u,width:c,loading:f=!1,disabled:x=!1,style:g={},Component:h="button",...p}=e,b=(0,l.useRef)(null),v=s()(m().root,{[m().slim]:"slim"===i,[m().loading]:f,[m().disabled]:x},n);return(0,t.jsxs)(h,{"aria-pressed":u,"data-variant":i,ref:(a=[b,r],e=>{a.forEach(r=>{"function"==typeof r?r(e):null!=r&&(r.current=e)})}),className:v,disabled:x,style:{width:c,...g},...p,children:[o,f&&(0,t.jsx)("i",{className:"flex pl-2 m-0",children:(0,t.jsx)(d,{})})]})});c.displayName="Button";var f=c},9233:function(e,r,a){"use strict";a.d(r,{Z:function(){return t.default}});var t=a(7568)},3101:function(e,r,a){"use strict";a.d(r,{Z:function(){return n}});var t=a(7437);function n(e){let{title:r,description:a,footer:n,children:s}=e;return(0,t.jsxs)("div",{className:"w-full max-w-3xl m-auto my-8 border rounded-md p border-zinc-700",children:[(0,t.jsxs)("div",{className:"px-5 py-4",children:[(0,t.jsx)("h3",{className:"mb-1 text-2xl font-medium",children:r}),(0,t.jsx)("p",{className:"text-zinc-300",children:a}),s]}),n&&(0,t.jsx)("div",{className:"p-4 border-t rounded-b-md border-zinc-700 bg-zinc-900 text-zinc-500",children:n})]})}},41:function(e,r,a){"use strict";a.d(r,{e:function(){return n}});var t=a(4756);function n(){return(0,t.AY)("https://kjhcbheufrehjmmkvdja.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtqaGNiaGV1ZnJlaGptbWt2ZGphIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTk0MDExMzQsImV4cCI6MjAzNDk3NzEzNH0.wIYaakQLfvun7pElhrLphnwk8dwTzZ4bvXmwsCZ7EZY")}},7335:function(e){e.exports={root:"Button_root__3fIL8",loading:"Button_loading__R7Yd5",slim:"Button_slim__eaYER",disabled:"Button_disabled__wUorh"}},1085:function(e){e.exports={root:"LoadingDots_root__8o4w0",blink:"LoadingDots_blink__iunUN"}},6800:function(e,r){var a;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var t={}.hasOwnProperty;function n(){for(var e="",r=0;r<arguments.length;r++){var a=arguments[r];a&&(e=s(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var r="";for(var a in e)t.call(e,a)&&e[a]&&(r=s(r,a));return r}(a)))}return e}function s(e,r){return r?e?e+" "+r:e+r:e}e.exports?(n.default=n,e.exports=n):void 0!==(a=(function(){return n}).apply(r,[]))&&(e.exports=a)}()}}]);