(()=>{var e={};e.id=346,e.ids=[346],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},6895:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>d,pages:()=>u,routeModule:()=>f,tree:()=>c}),r(84132),r(41381),r(35866);var s=r(23191),a=r(88716),n=r(37922),o=r.n(n),i=r(95231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c=["",{children:["account",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,84132)),"/Users/scroobz/Documents/Projects/NK/app/account/page.tsx"]}]},{metadata:{icon:[],apple:[],openGraph:[async e=>(await Promise.resolve().then(r.bind(r,4362))).default(e)],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,41381)),"/Users/scroobz/Documents/Projects/NK/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[],apple:[],openGraph:[async e=>(await Promise.resolve().then(r.bind(r,4362))).default(e)],twitter:[],manifest:void 0}}],u=["/Users/scroobz/Documents/Projects/NK/app/account/page.tsx"],d="/account/page",m={require:r,loadChunk:()=>Promise.resolve()},f=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/account/page",pathname:"/account",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},86358:(e,t,r)=>{Promise.resolve().then(r.bind(r,32002)),Promise.resolve().then(r.bind(r,79403)),Promise.resolve().then(r.bind(r,96728))},32002:(e,t,r)=>{"use strict";r.d(t,{AccountFormAsPage:()=>c,default:()=>l});var s=r(10326),a=r(17577),n=r(82782),o=r(54554),i=r(710);function l({user:e}){let t=(0,n.e)(),[r,l]=(0,a.useState)(!0),[c,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(null),[x,g]=(0,a.useState)(void 0);async function h(){try{if(l(!0),f){let{id:e,...r}=f,{error:s}=await t.from("userdatas").update(r).eq("id",e);if(s)throw s}else{let{error:e}=await t.from("userdatas").insert({e_mail:x,memberid:d?parseInt(d):null,fanclub:"",nachname:"",vorname:"",adresse:"",plz:""}).single();if(e)throw e;let{data:r,error:s}=await t.from("userdatas").select("*").eq("e_mail",x).single();if(s)throw s;p(r||{}),m(r?.memberid?.toString()||"")}let{error:r}=await t.from("users").update({full_name:c,userdatas:f?.id||d?parseInt(d):null}).eq("id",e?.id);if(r)throw r;alert("Profile updated!")}catch(e){console.error("Error updating profile:",e.message),alert("Error updating profile!")}finally{l(!1)}}async function b(){try{l(!0);let{data:e,error:r}=await t.from("userdatas").select("memberid").order("memberid",{ascending:!1}).limit(1).single();if(r)throw r;let s=e?e.memberid+1:1,{error:a}=await t.from("userdatas").update({memberid:s}).eq("id",f?.id);if(a)throw a;m(s.toString()),alert("New Member ID generated!")}catch(e){console.error("Error generating member ID:",e.message),alert("Error generating member ID!")}finally{l(!1)}}(0,a.useCallback)(async()=>{try{if(l(!0),console.log("Fetching profile data for user ID:",e?.id),console.log("Fetching profile data for user email:",x),!x){console.warn("User email is undefined, cannot fetch userdatas");return}let{data:r,error:s,status:a}=await t.from("users").select("full_name, userdatas").eq("id",e?.id).single();if(s&&406!==a)throw console.error(s),s;if(r){if(u(r.full_name),r.userdatas){console.log("Userdatas ID found, fetching userdatas");let{data:s,error:a}=await t.from("userdatas").select("*").eq("id",r.userdatas).single();if(s)p(s),null!=s.memberid&&m(s.memberid.toString());else{console.warn("Userdatas ID is invalid, fetching userdatas by email:",x);let{data:r,error:s}=await t.from("userdatas").select("*").eq("e_mail",x).single();if(r){p(r);let{error:s}=await t.from("users").update({userdatas:r.id}).eq("id",e?.id);if(s)throw s;null!=r.memberid&&m(r.memberid.toString())}else console.warn("No matching email found in userdatas table"),p(null)}}else{console.log("No userdatas ID, fetching userdatas by email:",x);let{data:r,error:s}=await t.from("userdatas").select("*").eq("e_mail",x).single();if(r){p(r);let{error:s}=await t.from("users").update({userdatas:r.id}).eq("id",e?.id);if(s)throw s;null!=r.memberid&&m(r.memberid.toString())}else console.warn("No matching email found in userdatas table"),p(null)}}}catch(e){console.error("Error loading user data:",e.message),alert("Error loading user data!")}finally{l(!1)}},[e,x,t]);let y=e=>{let{name:t,value:r}=e.target;p(e=>({...e,[t]:r}))};return s.jsx(i.Z,{title:"Your Profile",footer:s.jsx(o.Z,{variant:"slim",onClick:h,disabled:r,loading:r,children:r?"Loading ...":"Update"}),children:s.jsx("div",{className:"form-widget space-y-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email"}),s.jsx("input",{id:"email",type:"text",value:e?.email,disabled:!0,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"fullname",className:"text-sm font-medium text-gray-700",children:"Full Name"}),s.jsx("input",{id:"fullname",name:"fullname",type:"text",value:c||"",onChange:e=>u(e.target.value),className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"memberid",className:"text-sm font-medium text-gray-700",children:"Member ID"}),s.jsx("input",{id:"memberid",name:"memberid",type:"text",value:d,onChange:e=>m(e.target.value),className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"}),s.jsx("button",{type:"button",onClick:b,className:"mt-2 px-4 py-2 bg-pink-600 text-white rounded-md hover:bg-pink-700",children:"Generate Member ID"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"fanclub",className:"text-sm font-medium text-gray-700",children:"Fanclub"}),s.jsx("input",{id:"fanclub",name:"fanclub",type:"text",value:f?.fanclub||"",onChange:y,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"nachname",className:"text-sm font-medium text-gray-700",children:"Nachname"}),s.jsx("input",{id:"nachname",name:"nachname",type:"text",value:f?.nachname||"",onChange:y,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"vorname",className:"text-sm font-medium text-gray-700",children:"Vorname"}),s.jsx("input",{id:"vorname",name:"vorname",type:"text",value:f?.vorname||"",onChange:y,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"adresse",className:"text-sm font-medium text-gray-700",children:"Adresse"}),s.jsx("input",{id:"adresse",name:"adresse",type:"text",value:f?.adresse||"",onChange:y,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"plz",className:"text-sm font-medium text-gray-700",children:"PLZ"}),s.jsx("input",{id:"plz",name:"plz",type:"text",value:f?.plz||"",onChange:y,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("label",{htmlFor:"e_mail",className:"text-sm font-medium text-gray-700",children:"E-Mail"}),s.jsx("input",{id:"e_mail",name:"e_mail",type:"text",value:f?.e_mail||"",onChange:y,className:"mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-500"})]})]})})})}async function c(){let e=(0,n.e)(),{data:{user:t}}=await e.auth.getUser();return s.jsx(l,{user:t})}},79403:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var s=r(10326),a=r(54554),n=r(35047),o=r(17577),i=r(40731),l=r(90434),c=r(710);function u({subscription:e}){let t=(0,n.useRouter)(),r=(0,n.usePathname)(),[u,d]=(0,o.useState)(!1),m=e&&new Intl.NumberFormat("en-US",{style:"currency",currency:e?.prices?.currency,minimumFractionDigits:0}).format((e?.prices?.unit_amount||0)/100),f=async()=>{d(!0);let e=await (0,i.p)(r);return d(!1),t.push(e)};return s.jsx(c.Z,{title:"Your Plan",description:e?`You are currently on the ${e?.prices?.products?.name} plan.`:"You are not currently subscribed to any plan.",footer:(0,s.jsxs)("div",{className:"flex flex-col items-start justify-between sm:flex-row sm:items-center",children:[s.jsx("p",{className:"pb-4 sm:pb-0",children:"Manage your subscription on Stripe."}),s.jsx(a.Z,{variant:"slim",onClick:f,loading:u,children:"Open customer portal"})]}),children:s.jsx("div",{className:"mt-8 mb-4 text-xl font-semibold",children:e?`${m}/${e?.prices?.interval}`:s.jsx(l.default,{href:"/",children:"Choose your plan"})})})}},96728:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var s=r(10326),a=r(54554),n=r(710),o=r(94889),i=r(45941),l=r(35047),c=r(17577);function u({userEmail:e}){let t=(0,l.useRouter)(),[r,u]=(0,c.useState)(!1),d=async r=>{if(u(!0),r.currentTarget.newEmail.value===e){r.preventDefault(),u(!1);return}(0,i.X)(r,o.s,t),u(!1)};return s.jsx(n.Z,{title:"Your Email",description:"Please enter the email address you want to use to login.",footer:(0,s.jsxs)("div",{className:"flex flex-col items-start justify-between sm:flex-row sm:items-center",children:[s.jsx("p",{className:"pb-4 sm:pb-0",children:"We will email you to verify the change."}),s.jsx(a.Z,{variant:"slim",type:"submit",form:"emailForm",loading:r,children:"Update Email"})]}),children:s.jsx("div",{className:"mt-8 mb-4 text-xl font-semibold",children:s.jsx("form",{id:"emailForm",onSubmit:e=>d(e),children:s.jsx("input",{type:"text",name:"newEmail",className:"w-1/2 p-3 rounded-md bg-zinc-800",defaultValue:e??"",placeholder:"Your email",maxLength:64})})})})}},710:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(10326);function a({title:e,description:t,footer:r,children:a}){return(0,s.jsxs)("div",{className:"w-full max-w-3xl m-auto my-8 border rounded-md p border-zinc-700",children:[(0,s.jsxs)("div",{className:"px-5 py-4",children:[s.jsx("h3",{className:"mb-1 text-2xl font-medium",children:e}),s.jsx("p",{className:"text-zinc-300",children:t}),a]}),r&&s.jsx("div",{className:"p-4 border-t rounded-b-md border-zinc-700 bg-zinc-900 text-zinc-500",children:r})]})}},39950:(e,t,r)=>{"use strict";r.d(t,{PZ:()=>l,ZP:()=>i});var s=r(68570);let a=(0,s.createProxy)(String.raw`/Users/scroobz/Documents/Projects/NK/app/account/data/userData.tsx`),{__esModule:n,$$typeof:o}=a;a.default;let i=(0,s.createProxy)(String.raw`/Users/scroobz/Documents/Projects/NK/app/account/data/userData.tsx#default`),l=(0,s.createProxy)(String.raw`/Users/scroobz/Documents/Projects/NK/app/account/data/userData.tsx#AccountFormAsPage`)},84132:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(19510),a=r(68570);let n=(0,a.createProxy)(String.raw`/Users/scroobz/Documents/Projects/NK/components/ui/AccountForms/CustomerPortalForm.tsx`),{__esModule:o,$$typeof:i}=n;n.default;let l=(0,a.createProxy)(String.raw`/Users/scroobz/Documents/Projects/NK/components/ui/AccountForms/CustomerPortalForm.tsx#default`),c=(0,a.createProxy)(String.raw`/Users/scroobz/Documents/Projects/NK/components/ui/AccountForms/EmailForm.tsx`),{__esModule:u,$$typeof:d}=c;c.default;let m=(0,a.createProxy)(String.raw`/Users/scroobz/Documents/Projects/NK/components/ui/AccountForms/EmailForm.tsx#default`);var f=r(58585),p=r(1804),x=r(74826),g=r(39950);async function h(){let e=(0,p.e)(),[t,r,a]=await Promise.all([(0,x.PR)(e),(0,x.M_)(e),(0,x.pI)(e)]);return t?(0,s.jsxs)("section",{className:"mb-32 bg-white",children:[s.jsx("div",{className:"max-w-6xl px-4 py-8 mx-auto sm:px-6 sm:pt-24 lg:px-8",children:(0,s.jsxs)("div",{className:"sm:align-center sm:flex sm:flex-col",children:[s.jsx("h1",{className:"text-4xl font-extrabold text-black sm:text-center sm:text-6xl",children:"Account"}),s.jsx("p",{className:"max-w-2xl m-auto mt-5 text-xl text-gray-700 sm:text-center sm:text-2xl",children:"Manage your account & user data here"})]})}),(0,s.jsxs)("div",{className:"p-4",children:[s.jsx(l,{subscription:a}),s.jsx(m,{userEmail:t.email})]}),s.jsx(g.PZ,{})]}):(0,f.redirect)("/signin")}},58585:(e,t,r)=>{"use strict";var s=r(61085);r.o(s,"redirect")&&r.d(t,{redirect:function(){return s.redirect}})},61085:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return o},RedirectType:function(){return s.RedirectType},notFound:function(){return a.notFound},permanentRedirect:function(){return s.permanentRedirect},redirect:function(){return s.redirect}});let s=r(83953),a=r(16399);class n extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class o extends URLSearchParams{append(){throw new n}delete(){throw new n}set(){throw new n}sort(){throw new n}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},16399:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isNotFoundError:function(){return a},notFound:function(){return s}});let r="NEXT_NOT_FOUND";function s(){let e=Error(r);throw e.digest=r,e}function a(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8586:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return r}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},83953:(e,t,r)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RedirectType:function(){return s},getRedirectError:function(){return l},getRedirectStatusCodeFromError:function(){return p},getRedirectTypeFromError:function(){return f},getURLFromRedirectError:function(){return m},isRedirectError:function(){return d},permanentRedirect:function(){return u},redirect:function(){return c}});let a=r(54580),n=r(72934),o=r(8586),i="NEXT_REDIRECT";function l(e,t,r){void 0===r&&(r=o.RedirectStatusCode.TemporaryRedirect);let s=Error(i);s.digest=i+";"+t+";"+e+";"+r+";";let n=a.requestAsyncStorage.getStore();return n&&(s.mutableCookies=n.mutableCookies),s}function c(e,t){void 0===t&&(t="replace");let r=n.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?o.RedirectStatusCode.SeeOther:o.RedirectStatusCode.TemporaryRedirect)}function u(e,t){void 0===t&&(t="replace");let r=n.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?o.RedirectStatusCode.SeeOther:o.RedirectStatusCode.PermanentRedirect)}function d(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r,s,a]=e.digest.split(";",4),n=Number(a);return t===i&&("replace"===r||"push"===r)&&"string"==typeof s&&!isNaN(n)&&n in o.RedirectStatusCode}function m(e){return d(e)?e.digest.split(";",3)[2]:null}function f(e){if(!d(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function p(e){if(!d(e))throw Error("Not a redirect error");return Number(e.digest.split(";",4)[3])}(function(e){e.push="push",e.replace="replace"})(s||(s={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,35,621,296,92,583],()=>r(6895));module.exports=s})();